<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡åº†å¤§å­¦å°é’ğŸŸäººæ ¼æµ‹è¯„</title>
    <!-- å¼•å…¥ dom-to-image åº“ï¼ˆCDNï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/dom-to-image@2.6.0/dist/dom-to-image.min.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", sans-serif;
        }
        
        body {
            background-color: #FFF9F2;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-image: radial-gradient(#FF8C3810 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* å¡ç‰‡å®¹å™¨ */
        .container {
            width: 100%;
            max-width: 700px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(255, 140, 56, 0.1);
            overflow: hidden;
            position: relative;
        }
        
        /* é¡µé¢é€šç”¨æ ·å¼ */
        .section {
            padding: 40px;
            display: none;
        }
        
        .active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* æ¬¢è¿é¡µä¼˜åŒ–æ ·å¼ */
        .welcome-container {
            text-align: center;
            padding: 60px 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 500px;
        }
        
        .welcome-icon {
            font-size: 80px;
            margin-bottom: 30px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        .welcome-title {
            font-size: 32px;
            color: #FF8C38;
            margin-bottom: 20px;
            background: linear-gradient(90deg, #FF8C38, #FFB067);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 40px;
            max-width: 500px;
            line-height: 1.8;
        }
        
        .welcome-features {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .welcome-feature {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            max-width: 120px;
        }
        
        .feature-icon {
            font-size: 30px;
            color: #FF8C38;
        }
        
        .feature-text {
            font-size: 14px;
            color: #666;
        }
        
        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            color: #FF8C38;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        h2 {
            color: #FF8C38;
            margin-bottom: 20px;
            font-size: 22px;
        }
        
        h3 {
            color: #555;
            margin-bottom: 25px;
            font-size: 18px;
            font-weight: normal;
            text-align: center;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background-color: #FF8C38;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background-color: #FF7A18;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 122, 24, 0.3);
        }
        
        .btn:disabled {
            background-color: #FFD28F;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        /* ä¸‹è½½æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
        .download-btn {
            background-color: #4CAF50;
        }
        
        .download-btn:hover {
            background-color: #45a049;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        /* é¢˜ç›®æ ·å¼ */
        .question {
            font-size: 20px;
            margin-bottom: 30px;
            font-weight: 500;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .option {
            padding: 15px 20px;
            border: 2px solid #FFD28F;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .option:hover {
            background-color: #FFF5EB;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 140, 56, 0.1);
        }
        
        .option.selected {
            background-color: #FF8C38;
            color: white;
            border-color: #FF8C38;
        }
        
        .option.selected::after {
            content: "âœ“";
            position: absolute;
            right: 20px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .progress {
            height: 8px;
            background-color: #FFE8D2;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: #FF8C38;
            border-radius: 4px;
            transition: width 0.3s ease;
            background: linear-gradient(90deg, #FF8C38, #FFA563);
        }
        
        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
        }
        
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #FFD28F;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: #FF8C38;
            box-shadow: 0 0 0 3px rgba(255, 140, 56, 0.1);
        }
        
        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border: 1px solid #FFD28F;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .checkbox-item input, .radio-item input {
            width: 16px;
            height: 16px;
            margin: 0;
            flex-shrink: 0;
        }
        
        .checkbox-item label, .radio-item label {
            margin: 0;
            cursor: pointer;
            line-height: 1.2;
        }
        
        .checkbox-item:hover, .radio-item:hover {
            background-color: #FFF5EB;
            transform: translateY(-2px);
        }
        
        input[type="checkbox"]:checked + label, 
        input[type="radio"]:checked + label {
            color: #FF8C38;
            font-weight: bold;
        }
        
        input[type="checkbox"]:checked, input[type="radio"]:checked {
            accent-color: #FF8C38;
        }
        
        /* ç»“æœé¡µæ ·å¼ */
        .result-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .result-header::after {
            content: "";
            display: block;
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #FF8C38, transparent);
            margin: 20px auto 0;
        }
        
        .result-card {
            text-align: center;
            padding: 40px 30px;
            background: linear-gradient(135deg, #FFF5EB, #FFFAF2);
            border-radius: 20px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(255, 140, 56, 0.1);
        }
        
        .result-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #FF8C38, #FFB067);
        }
        
        .personality-type {
            font-size: 24px;
            color: #FF8C38;
            font-weight: bold;
            margin: 15px 0;
            letter-spacing: 1px;
        }
        
        .personality-name {
            font-size: 28px;
            margin-bottom: 20px;
            color: #333;
            font-weight: 600;
        }
        
        .personality-desc {
            color: #666;
            line-height: 1.8;
            font-size: 16px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .info-card {
            background-color: #FFF9F2;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border-left: 4px solid #FF8C38;
            box-shadow: 0 5px 15px rgba(255, 140, 56, 0.08);
        }
        
        .info-card h2 {
            margin-bottom: 20px;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-card h2::before {
            content: "ğŸ“";
            font-size: 20px;
        }
        
        .info-list {
            list-style: none;
            text-align: left;
            margin: 0;
            padding-left: 20px;
            line-height: 1.8;
        }
        
        /* å››ç»´ç®€ä»‹æ ·å¼ä¼˜åŒ– */
        #dimension-summary li {
            margin-bottom: 18px;
            font-size: 15px;
            position: relative;
        }
        
        #dimension-summary li strong {
            color: #FF8C38;
            font-size: 16px;
        }
        
        #dimension-summary li li {
            margin-bottom: 10px;
            padding-left: 5px;
            color: #555;
        }
        
        .result-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #FFE8D2;
        }
        
        /* é”™è¯¯æç¤ºæ ·å¼ */
        .error-message {
            color: #FF4444;
            text-align: center;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #FFF0F0;
            border-radius: 8px;
            display: none;
            border: 1px solid #FFCCCC;
        }
        
        .error-message.show {
            display: block;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* é¢˜ç›®é¡µæç¤º */
        .question-error {
            color: #FF4444;
            text-align: center;
            margin: 10px 0;
            display: none;
        }
        
        .question-error.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* ä¿¡ä»¶é¡µé¢æ ·å¼ */
        .letter-content {
            line-height: 1.8;
            font-size: 16px;
            padding: 30px;
            background: linear-gradient(135deg, #FFF5EB, #FFFAF2);
            border-radius: 15px;
            min-height: 400px;
            position: relative;
            box-shadow: 0 5px 15px rgba(255, 140, 56, 0.08);
            white-space: pre-line;
            color: #333; /* ç¡®ä¿æ–‡å­—é¢œè‰² */
            cursor: pointer; /* æ·»åŠ é¼ æ ‡æŒ‡é’ˆæ ·å¼ */
        }
        
        .letter-content strong {
            color: #FF8C38;
        }
        
        /* é«˜äº®æ–‡æœ¬æ ·å¼ */
        .highlight-text {
            font-weight: bold;
            color: #FF8C38;
        }
        
        .signature {
            text-align: right;
            margin-top: 30px;
        }
        
        .typing::after {
            content: "|";
            animation: blink 1s infinite;
            color: #FF8C38;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        /* æˆªå›¾ä¸“ç”¨æ ·å¼ - ç¡®ä¿èƒŒæ™¯å’Œæ–‡å­—æ¸…æ™° */
        .screenshot-target {
            background-color: white !important;
            color: #333 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        
        /* åŠ è½½æç¤ºæ ·å¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #FFE8D2;
            border-top: 5px solid #FF8C38;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 18px;
            color: #FF8C38;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ¬¢è¿é¡µï¼ˆä¼˜åŒ–ç‰ˆï¼‰ -->
        <div id="welcome-section" class="section active">
            <div class="welcome-container">
                <div class="welcome-icon">ğŸŸ</div>
                <h1 class="welcome-title">é‡åº†å¤§å­¦å°é’ğŸŸäººæ ¼æµ‹è¯„</h1>
                <p class="welcome-subtitle">æ¢ç´¢ä½ çš„å¿—æ„¿æœåŠ¡ç‰¹è´¨ï¼Œæ‰¾åˆ°å±äºä½ çš„å¿—æ„¿è€…äººæ ¼ï¼Œè®©æ¯ä¸€ä»½å–„æ„éƒ½é—ªé—ªå‘å…‰</p>
                
                <div class="welcome-features">
                    <div class="welcome-feature">
                        <div class="feature-icon">ğŸ§­</div>
                        <div class="feature-text">ç²¾å‡†æµ‹è¯„</div>
                    </div>
                    <div class="welcome-feature">
                        <div class="feature-icon">ğŸ’¡</div>
                        <div class="feature-text">ä¸ªæ€§åˆ†æ</div>
                    </div>
                    <div class="welcome-feature">
                        <div class="feature-icon">âœ‰ï¸</div>
                        <div class="feature-text">ä¸“å±ä¿¡ä»¶</div>
                    </div>
                </div>
                
                <button id="start-btn" class="btn" style="padding: 15px 40px; font-size: 18px;">å¼€å§‹æµ‹è¯„</button>
            </div>
        </div>

        <!-- é¢˜ç›®é¡µ -->
        <div id="question-section" class="section">
            <div class="progress">
                <div id="progress-bar" class="progress-bar" style="width: 10%;"></div>
            </div>
            <div id="question-number"></div>
            <div id="question-text" class="question"></div>
            
            <!-- é¢˜ç›®é”™è¯¯æç¤º -->
            <div id="question-error" class="question-error">è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹åç»§ç»­ï¼</div>
            
            <div id="options-container" class="options"></div>
            <div class="btn-group">
                <button id="prev-btn" class="btn" disabled>ä¸Šä¸€é¢˜</button>
                <button id="next-btn" class="btn">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- æˆå°±å±•æœ›é¡µ -->
        <div id="achievement-section" class="section">
            <h2>æˆå°±ä¸å±•æœ›</h2>
            
            <!-- é”™è¯¯æç¤º -->
            <div id="error-message" class="error-message"></div>
            
            <div class="form-group">
                <label for="nickname">å¿—æ„¿è€…æ˜µç§°</label>
                <input type="text" id="nickname" placeholder="è¯·è¾“å…¥ä½ çš„æ˜µç§°" required>
            </div>
            
            <div class="form-group">
                <label for="total-hours">ç´¯è®¡å¿—æ„¿æœåŠ¡æ—¶é•¿ï¼ˆå°æ—¶ï¼‰</label>
                <input type="number" id="total-hours" placeholder="è¯·è¾“å…¥æ—¶é•¿" min="0">
            </div>
            
            <div class="form-group">
                <label for="start-year">å¼€å§‹å¿—æ„¿æœåŠ¡çš„å¹´ä»½</label>
                <input type="number" id="start-year" placeholder="ä¾‹å¦‚ï¼š2022" min="2000" max="2026">
            </div>
            
            <div class="form-group">
                <label>å¿—æ„¿å¸¦ç»™ä½ çš„æ”¹å˜ï¼ˆå¯å¤šé€‰ï¼‰</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="change1" name="change" value="è®¤è¯†äº†æ–°æœ‹å‹">
                        <label for="change1">è®¤è¯†äº†æ–°æœ‹å‹</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="change2" name="change" value="å­¦ä¼šäº†æ–°æŠ€èƒ½">
                        <label for="change2">å­¦ä¼šäº†æ–°æŠ€èƒ½</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="change3" name="change" value="æ›´ç†è§£ç¤¾ä¼šé—®é¢˜">
                        <label for="change3">æ›´ç†è§£ç¤¾ä¼šé—®é¢˜</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="change4" name="change" value="æå‡äº†æ²Ÿé€šèƒ½åŠ›">
                        <label for="change4">æå‡äº†æ²Ÿé€šèƒ½åŠ›</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="change5" name="change" value="å¢å¼ºäº†è´£ä»»æ„Ÿ">
                        <label for="change5">å¢å¼ºäº†è´£ä»»æ„Ÿ</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>æ˜å¹´æœ€æƒ³å°è¯•çš„æœåŠ¡ç±»å‹</label>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="type1" name="next-type" value="çˆ±å¿ƒåŠ©è€">
                        <label for="type1">çˆ±å¿ƒåŠ©è€</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type2" name="next-type" value="æ”¯æ•™åŠ©å­¦">
                        <label for="type2">æ”¯æ•™åŠ©å­¦</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type3" name="next-type" value="èµ›äº‹æœåŠ¡">
                        <label for="type3">èµ›äº‹æœåŠ¡</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type4" name="next-type" value="ç¯ä¿å…¬ç›Š">
                        <label for="type4">ç¯ä¿å…¬ç›Š</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type5" name="next-type" value="ç¤¾åŒºæœåŠ¡">
                        <label for="type5">ç¤¾åŒºæœåŠ¡</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>ç”¨ä¸€ä¸ªè¯å½¢å®¹ä½ çš„å¿—æ„¿æœåŠ¡</label>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="desc1" name="description" value="æ¸©æš–">
                        <label for="desc1">æ¸©æš–</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="desc2" name="description" value="æˆé•¿">
                        <label for="desc2">æˆé•¿</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="desc3" name="description" value="è´£ä»»">
                        <label for="desc3">è´£ä»»</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="desc4" name="description" value="å¿«ä¹">
                        <label for="desc4">å¿«ä¹</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="desc5" name="description" value="ä»·å€¼">
                        <label for="desc5">ä»·å€¼</label>
                    </div>
                </div>
            </div>
            
            <div class="btn-group" style="justify-content: center;">
                <button id="submit-btn" class="btn">æŸ¥çœ‹ç»“æœ</button>
            </div>
        </div>

        <!-- æ€»ç»“é¡µï¼ˆç§»é™¤å¿—æ„¿æ¡£æ¡ˆï¼‰ -->
        <div id="result-section" class="section screenshot-target">
            <div class="result-header">
                <h1>ä½ çš„å¿—æ„¿è€…äººæ ¼</h1>
            </div>
            
            <div class="result-card">
                <div id="result-type" class="personality-type"></div>
                <div id="result-name" class="personality-name"></div>
                <div id="result-desc" class="personality-desc"></div>
            </div>
            
            <div class="info-card">
                <h2>å››ç»´ç®€ä»‹</h2>
                <ul id="dimension-summary" class="info-list"></ul>
            </div>
            
            <div class="result-footer">
                <!-- æ·»åŠ ä¸‹è½½æŒ‰é’® -->
                <button id="download-result-btn" class="btn download-btn">ä¸‹è½½ç»“æœå›¾ç‰‡</button>
                <button id="to-letter-btn" class="btn">è‡´å°é’é±¼çš„ä¸€å°ä¿¡</button>
            </div>
        </div>

        <!-- ä¿¡ä»¶é¡µ -->
        <div id="letter-section" class="section screenshot-target">
            <div class="result-header">
                <h1>è‡´å°é’é±¼çš„ä¸€å°ä¿¡</h1>
            </div>
            <div class="letter-content" id="letter-content"></div>
            <div class="btn-group" style="justify-content: center;">
                <!-- æ·»åŠ ä¸‹è½½æŒ‰é’® -->
                <button id="download-letter-btn" class="btn download-btn">ä¸‹è½½ä¿¡ä»¶å›¾ç‰‡</button>
                <button id="final-restart-btn" class="btn">é‡æ–°æµ‹è¯„</button>
            </div>
        </div>
    </div>

    <!-- åŠ è½½æç¤º -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">æ­£åœ¨ç”Ÿæˆå›¾ç‰‡ï¼Œè¯·ç¨å€™...</div>
    </div>

    <script>
        // é¢˜ç›®æ•°æ®
        const questions = [
            {
                text: "åˆ°è¾¾å¿—æ„¿æœåŠ¡ç‚¹åï¼Œä½ å‘ç°æ´»åŠ¨å¼‚å¸¸ç«çˆ†ï¼Œå·¥ä½œäººå‘˜äººæ‰‹ä¸è¶³ï¼Œéœ€è¦äººä¸´æ—¶è´Ÿè´£åˆ†å‘ç‰©èµ„ã€‚æ­¤æ—¶è´Ÿè´£äººæš‚ä¸åœ¨åœºï¼Œä½ ä¼šï¼š",
                options: [
                    { text: "A. ç«‹å³ä¸Šå‰ï¼Œä¸»åŠ¨æ¢³ç†æµç¨‹ã€ç»„ç»‡é˜Ÿä¼åˆ†å‘ç‰©èµ„ã€‚", dimension: ["L", "X", "S"] },
                    { text: "B. å…ˆåšåŠ›æ‰€èƒ½åŠçš„äº‹ï¼Œåç»­å¬ä»å®‰æ’ï¼Œè¢«æŒ‡æ´¾åœ¨å“ªé‡Œå°±åœ¨å“ªé‡Œå¸®å¿™ã€‚", dimension: ["T", "C", "H"] }
                ]
            },
            {
                text: "ç”±äºç²¾åŠ›æœ‰é™ï¼Œæœ¬å­¦æœŸä»¥ä¸‹ä¸¤ç§å¿—æ„¿æ´»åŠ¨æ¨¡å¼ä½ åªèƒ½é€‰æ‹©ä¸€ç§ã€‚åœ¨æ‰€è·å¿—æ„¿æ—¶é•¿ç›¸ç­‰çš„æƒ…å†µä¸‹ï¼Œä½ åå‘äºé€‰æ‹©ï¼š",
                options: [
                    { text: "A. é€‰æ‹©é•¿æœŸç¨³å®šçš„å¿—æ„¿æ´»åŠ¨ï¼Œå¦‚å¥³ç”Ÿå®‰å¿ƒè®¡åˆ’ã€è“ä¿¡å°ç­‰ã€‚", dimension: ["A", "C", "H"] },
                    { text: "B. æ—¶åˆ»å…³æ³¨é’åå¿—æ„¿ç¾¤ä¸QQé¢‘é“ï¼Œäº‰å–å¤šæ ·çš„å¿—æ„¿ä½“éªŒã€‚", dimension: ["E", "X", "S"] }
                ]
            },
            {
                text: "æ´»åŠ¨å¼€å±•å‰ï¼Œä½ ä»¬å¿—æ„¿å°ç»„éœ€è¦å†™ä¸€ä¸ªæœåŠ¡æ–¹æ¡ˆã€‚åœ¨ç»„å†…æš‚æœªç¡®å®šåˆ†å·¥æ—¶ï¼Œä½ å€¾å‘äºï¼š",
                options: [
                    { text: "A. ä¸»åŠ¨æå‡ºæ¡†æ¶ã€åˆ†å·¥ã€æ¨è¿›æ—¶é—´è¡¨ï¼Œä»æ•´ä½“æŠŠæ¡æ–¹å‘ä¸ä»»åŠ¡ã€‚", dimension: ["L", "X", "S"] },
                    { text: "B. æ ¹æ®åˆ«äººæ‹Ÿå®šçš„æ–¹æ¡ˆæä¾›è¡¥å……æ„è§ï¼Œç»†è‡´å®Œæˆå®è·µå†…å®¹ã€‚", dimension: ["T", "C", "H"] }
                ]
            },
            {
                text: "ç”±äºæ—¶é—´å†²çªï¼Œä»¥ä¸‹ä¸¤ç§å¿—æ„¿æ´»åŠ¨ä½ åªèƒ½é€‰æ‹©ä¸€ç§è¿›è¡Œä½“éªŒï¼Œä½ æ›´å–œæ¬¢ï¼š",
                options: [
                    { text: "A.å¿—æ„¿è¿‡ç¨‹ä¸­éœ€è¦æŒç»­æä¾›æœåŠ¡ï¼Œéœ€æ±‚è¾ƒä¸ºé›†ä¸­çš„å¿—æ„¿æ´»åŠ¨ï¼Œå¦‚ä¸€å¯¹ä¸€é™ªä¼´è¯»ä¹¦ã€èŠå¤©ã€å¿ƒç†æ…°è—‰ç­‰ã€‚", dimension: ["A", "C", "H"] },
                    { text: "B.å¿—æ„¿è¿‡ç¨‹ä¸­èŠ‚å¥å¿«ï¼Œéœ€æ±‚ä¸°å¯Œå¤šå˜çš„æ´»åŠ¨ï¼Œå¦‚å¤§å‹èµ›äº‹å¿—æ„¿ã€å±•ä¼šå¿—æ„¿ç­‰ã€‚", dimension: ["E", "X", "S"] }
                ]
            },
            {
                text: "å½“å›¢é˜Ÿå†…éƒ¨å‡ºç°æ„è§ä¸ç»Ÿä¸€ï¼Œä½ é€šå¸¸ä¼šï¼š",
                options: [
                    { text: "A. å…ˆè¯•å›¾æ•´åˆå„æ–¹æ„è§ï¼Œæå‡ºä¸€ä¸ªå¤§å®¶éƒ½èƒ½æ¥å—çš„æ–¹æ¡ˆã€‚", dimension: ["L", "C", "H"] },
                    { text: "B. å‚ä¸è®¨è®ºï¼Œå°Šé‡å›¢é˜Ÿå†³ç­–ï¼Œæ˜ç¡®ç›®æ ‡åè¿…é€Ÿæ‰§è¡Œè‡ªå·±è´Ÿè´£çš„éƒ¨åˆ†ã€‚", dimension: ["T", "X", "S"] }
                ]
            },
            {
                text: "åœ¨ä»¥ä¸‹ä¸¤é¡¹ä¸­ï¼Œä½ æ›´äº«å—å“ªç§å¿—æ„¿æ´»åŠ¨å¸¦ç»™ä½ çš„æˆå°±æ„Ÿï¼Ÿ",
                options: [
                    { text: "A. æœåŠ¡å¯¹è±¡å¯¹ä½ è¡¨è¾¾çš„ä¿¡ä»»ä¸æ„Ÿè°¢ï¼Œæ¯”å¦‚ä¸€å¥â€œè°¢è°¢ä½ ä»Šå¤©æ¥ï¼Œæˆ‘ç‰¹åˆ«æ¸©æš–å’Œé«˜å…´â€ã€‚", dimension: ["H", "C", "A"] },
                    { text: "B. æ¥è‡ªé¡¹ç›®é¡ºåˆ©å®Œæˆã€æµç¨‹ä¼˜åŒ–ã€è§£å†³äº†å›°éš¾ï¼Œå¦‚â€œå› ä¸ºä½ ï¼Œå›¢é˜Ÿå·¥ä½œæ•ˆç‡æé«˜äº†â€ã€‚", dimension: ["S", "X", "E"] }
                ]
            },
            {
                text: "å½“ä¸€ä¸ªæ–°æ´»åŠ¨éœ€è¦å¿—æ„¿è€…ï¼Œä½ æ›´å¯èƒ½å› ä¸ºå“ªç§ç†ç”±æŠ¥åï¼Ÿ",
                options: [
                    { text: "A. æƒ³å¸®åŠ©ç‰¹å®šäººç¾¤ã€å› ä¸ºâ€œè§‰å¾—ä»–ä»¬éœ€è¦ä½ â€ã€‚", dimension: ["H", "C"] },
                    { text: "B. æƒ³å°è¯•æ–°ä»»åŠ¡ã€æå‡æŠ€èƒ½ï¼Œæ¯”å¦‚å­¦ä¹ æ–°çš„ç™»è®°ç³»ç»Ÿã€‚", dimension: ["S", "X", "E"] }
                ]
            },
            {
                text: "å¦‚æœä½ è¢«å®‰æ’åˆ°å¾ˆéœ€è¦è€å¿ƒçš„å¿—æ„¿ä»»åŠ¡ï¼ˆå¦‚é€ä¸ªå®‰æŠšæƒ…ç»ªç´§å¼ çš„å®¶å±ï¼‰ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼š",
                options: [
                    { text: "A. è§‰å¾—æœ‰æ„ä¹‰ã€æœ‰æŠŠæ¡ï¼Œæ„¿æ„æ…¢æ…¢æ²Ÿé€šï¼Œå®‰æŠšå¹¶é™ªä¼´ä»–ä»¬ã€‚", dimension: ["C", "H", "A"] },
                    { text: "B. æ›´å¸Œæœ›è¢«å®‰æ’åˆ°æµç¨‹ç±»ã€æ•ˆç‡æ›´é‡è¦çš„å²—ä½ï¼Œå¦‚ç™»è®°ã€è°ƒåº¦ã€‚", dimension: ["X", "S", "E"] }
                ]
            },
            {
                text: "åœ¨å¿—æ„¿å›¢é˜Ÿä¸­ï¼Œä½ æœ€è‡ªç„¶å±•ç°çš„çŠ¶æ€æ˜¯ï¼š",
                options: [
                    { text: "A. ä¸»åŠ¨å…³æ³¨é˜Ÿå‹æƒ…ç»ªã€å…³å¿ƒæ˜¯å¦æœ‰äººéœ€è¦å¸®åŠ©æˆ–åè°ƒã€‚", dimension: ["C", "L", "H"] },
                    { text: "B. è´Ÿè´£æ¨åŠ¨å·¥ä½œèŠ‚å¥ï¼Œç¡®ä¿ä»»åŠ¡æŒ‰æ—¶æŒ‰é‡å®Œæˆã€‚", dimension: ["X", "S", "T"] }
                ]
            },
            {
                text: "å½“å¿—æ„¿é¡¹ç›®éœ€è¦é€‰å‡ºä¸€äººé•¿æœŸè´Ÿè´£è”ç»œåŠäº‹åŠ¡ç®¡ç†ï¼Œä½ ä¼šï¼š",
                options: [
                    { text: "A. æ„¿æ„æ‹…ä»»æ­¤ç±»æ ¸å¿ƒå²—ä½ï¼Œè´Ÿè´£æ²Ÿé€šåè°ƒå’Œé•¿æœŸè·Ÿè¿›ã€‚", dimension: ["L", "A", "H"] },
                    { text: "B. æ›´å¸Œæœ›æŒ‰é˜¶æ®µå‚ä¸é¡¹ç›®ï¼Œå®Œæˆæ¸…æ™°çš„å…·ä½“ä»»åŠ¡åç»§ç»­æ¢ç´¢ä¸‹ä¸€ä¸ªé¡¹ç›®ã€‚", dimension: ["T", "E", "S", "X"] }
                ]
            }
        ];

        // äººæ ¼ç±»å‹æ•°æ®
        const personalities = {
            "H-L-A-C": { name: "æ¸©æƒ…å®ˆæŠ¤å‹å°é’é±¼", desc: "ä½ ä»¥çœŸæŒšçš„æƒ…æ„Ÿä¸ºåŸç‚¹ï¼Œä¹ æƒ¯åœ¨å¿—æ„¿æœåŠ¡ä¸­ä¸»åŠ¨æ‰¿æ‹…å¼•é¢†è§’è‰²ï¼Œç”¨ç»†è‡´çš„å…³æ€€ä¸ºæœåŠ¡å¯¹è±¡å¸¦æ¥æŒä¹…æ¸©æš–ã€‚ä½ æ˜¯å›¢é˜Ÿä¸­æœ€ä»¤äººå®‰å¿ƒçš„å®ˆæŠ¤è€…ï¼Œç”¨æ—¶é—´ä¸è€å¿ƒæ„ç­‘ä¿¡ä»»çš„æ¡¥æ¢ã€‚" },
            "H-L-A-X": { name: "åšå®åç›¾å‹å°é’é±¼", desc: "ä½ æ€€æ£çƒ­å¿±ä¹‹å¿ƒï¼Œåœ¨ç†Ÿæ‚‰çš„å¿—æ„¿æœåŠ¡ä¸­æ‰®æ¼”ç»„ç»‡è€…è§’è‰²ã€‚æ³¨é‡æ•ˆç‡ä¸æ‰§è¡Œï¼Œæ€»èƒ½ç¨³å¦¥åœ°å®Œæˆæ¯ä¸€é¡¹ä»»åŠ¡ã€‚è™½ç„¶ä¸å¸¸è¡¨éœ²æƒ…æ„Ÿï¼Œå´æ˜¯å›¢é˜Ÿä¸­æœ€å€¼å¾—ä¿¡èµ–çš„æ”¯æŒåŠ›é‡ã€‚" },
            "H-T-A-C": { name: "æ¸©æš–é™ªä¼´å‹å°é’é±¼", desc: "ä½ å› å†…å¿ƒçš„æ„ŸåŠ¨è€ŒæŠ•èº«æœåŠ¡ï¼Œæ›´æ„¿æ„ä»¥é…åˆè€…çš„èº«ä»½é»˜é»˜ä»˜å‡ºã€‚åœ¨ç¨³å®šçš„æœåŠ¡ç¯å¢ƒä¸­ï¼Œä½ ç»†è…»ä½“è´´ï¼Œå–„äºå€¾å¬ä¸é™ªä¼´ã€‚ä½ çš„å­˜åœ¨ï¼Œæœ¬èº«å°±æ˜¯ä¸€ç§æ¸©æŸ”çš„åŠ›é‡ã€‚" },
            "H-T-A-X": { name: "é™é»˜è€•è€˜å‹å°é’é±¼", desc: "ä½ ç§‰æŒå†…å¿ƒçš„ä¿¡å¿µï¼Œä¸“æ³¨äºåœ¨å›ºå®šæœåŠ¡ä¸­é«˜æ•ˆå®Œæˆä»»åŠ¡ã€‚ä¸è¿½æ±‚æŒå£°ï¼Œå´æ€»èƒ½ä»¥è¸å®çš„æ€åº¦èµ¢å¾—å°Šé‡ã€‚ä½ æ˜¯é‚£ç§åœ¨å¹•åé»˜é»˜å‘å…‰çš„å°é’é±¼ã€‚" },
            "H-L-E-C": { name: "çˆ±å¿ƒä¼ é€’å‹å°é’é±¼", desc: "ä½ å¸¦ç€ä¸€é¢—çƒ­å¿±çš„å¿ƒï¼Œä¸æ–­æ¢ç´¢ä¸åŒç±»å‹çš„å¿—æ„¿æœåŠ¡ï¼Œå¹¶ä¹äºåœ¨å…¶ä¸­æ‹…ä»»å‘èµ·äººæˆ–åè°ƒè€…ã€‚ä½ æ“…é•¿ç”¨å…³æ€€æ­å»ºäººä¸äººä¹‹é—´çš„è”ç»“ï¼Œè®©æ¸©æš–åœ¨ä¸åŒè§’è½æµåŠ¨ã€‚" },
            "H-L-E-X": { name: "çƒ­è¡€å…ˆé”‹å‹å°é’é±¼", desc: "ä½ å› çƒ­çˆ±è€Œè¡ŒåŠ¨ï¼Œå‹‡äºå°è¯•æ–°é¢†åŸŸå¹¶ä¸»åŠ¨æ‰¿æ‹…å¼•é¢†èŒè´£ã€‚ä½ æ³¨é‡ç›®æ ‡ä¸æˆæ•ˆï¼Œå–„äºåœ¨å˜åŒ–ä¸­å¿«é€Ÿæ‰“å¼€å±€é¢ï¼Œæ˜¯å¼€æ‹“å¿—æ„¿æœåŠ¡æ–°å¯èƒ½çš„å…ˆé”‹è€…ã€‚" },
            "H-T-E-C": { name: "æš–å¿ƒæ—…äººå½¢å°é’é±¼", desc: "ä½ éšç€å†…å¿ƒçš„æŒ‡å¼•ï¼Œç©¿æ¢­äºå¤šæ ·åŒ–çš„å¿—æ„¿æœåŠ¡ä¸­ï¼Œä»¥é…åˆè€…çš„å§¿æ€ç•™ä¸‹æ¸©æš–çš„ç—•è¿¹ã€‚ä½ å…³æ³¨æ¯ä¸€ä¸ªä¸ªä½“çš„éœ€æ±‚ï¼Œç”¨çŸ­æš‚çš„ç›¸é‡ä¼ é€’é•¿ä¹…çš„ç¾å¥½ã€‚" },
            "H-T-E-X": { name: "å¿«ä¹è¡ŒåŠ¨æ´¾å°é’é±¼", desc: "ä½ å› å¿«ä¹è€ŒæœåŠ¡ï¼Œä¹äºå°è¯•å„ç±»å¿—æ„¿é¡¹ç›®å¹¶é«˜æ•ˆé…åˆå›¢é˜Ÿå®Œæˆä»»åŠ¡ã€‚ä½ ä¸ä»…è‡ªå·±äº«å—å…¶ä¸­ï¼Œä¹Ÿç”¨ç§¯æèƒ½é‡æ„ŸæŸ“èº«è¾¹çš„æ¯ä¸€ä¸ªäººã€‚" },
            "S-L-A-C": { name: "ä¸“ä¸šå›­ä¸å‹å°é’é±¼", desc: "ä½ ä»¥ä¸“ä¸šæŠ€èƒ½ä¸ºæ ¹åŸºï¼Œåœ¨å›ºå®šæœåŠ¡é¢†åŸŸä¸­æ‰¿æ‹…ç»„ç»‡è€…è§’è‰²ã€‚ä½ ä¸ä»…ä¼ æˆçŸ¥è¯†ï¼Œæ›´æ³¨é‡ä»¥å…³æ€€ä¹‹å¿ƒé™ªä¼´æœåŠ¡å¯¹è±¡æˆé•¿ï¼Œæ˜¯å€¼å¾—ä¾é çš„â€œå›­ä¸å‹â€å¿—æ„¿è€…ã€‚" },
            "S-L-A-X": { name: "æ¶æ„å¸ˆå‹å°é’é±¼", desc: "ä½ å‡­å€Ÿä¸“ä¸šèƒ½åŠ›ï¼Œåœ¨ç¨³å®šæœåŠ¡ä¸­æ‰®æ¼”å¼•é¢†è€…ï¼Œå¹¶ç€çœ¼äºæ„å»ºæ¸…æ™°é«˜æ•ˆçš„æœåŠ¡æµç¨‹ã€‚ä½ å–„äºç³»ç»ŸåŒ–åœ°è§£å†³é—®é¢˜ï¼Œæ˜¯å¿—æ„¿æœåŠ¡ä¸­çš„â€œéšå½¢å¼•æ“â€ã€‚" },
            "S-T-A-C": { name: "åŒ å¿ƒä¸“å‘˜å‹å°é’é±¼", desc: "ä½ å°†ä¸“ä¸šä¸å…³æ€€èä¸ºä¸€ä½“ï¼Œåœ¨å›ºå®šæœåŠ¡ç‚¹ä¸­ä»¥é…åˆè€…çš„èº«ä»½è¿½æ±‚æ¯ä¸€ä¸ªç»†èŠ‚çš„å®Œå–„ã€‚ä½ ç›¸ä¿¡ï¼ŒçœŸæ­£çš„ä¸“ä¸šæ˜¯æŠ€æœ¯ä¸æ¸©åº¦çš„ç»“åˆã€‚" },
            "S-T-A-X": { name: "æ•ˆèƒ½ä¸“å®¶å‹å°é’é±¼", desc: "ä½ ä»¥æŠ€èƒ½ä¸ºæœ¬ï¼Œåœ¨ç†Ÿæ‚‰çš„æœåŠ¡åœºæ™¯ä¸­ä¸“æ³¨æå‡æ‰§è¡Œæ•ˆç‡ã€‚ä½ è™½ä¸å¼ æ‰¬ï¼Œå´æ€»èƒ½åœ¨æµç¨‹ä¸­æ‰¾åˆ°ä¼˜åŒ–ç‚¹ï¼Œæ˜¯å›¢é˜Ÿä¸­ä¸å¯æˆ–ç¼ºçš„â€œæ•ˆèƒ½æ‹…å½“â€ã€‚" },
            "S-L-E-C": { name: "å¯è¿ªå¯¼å¸ˆå‹å°é’é±¼", desc: "ä½ å¸¦ç€ä¸“ä¸šçŸ¥è¯†èµ°å‘å¤šæ ·åŒ–çš„å¿—æ„¿æœåŠ¡ï¼Œå¹¶ä¸»åŠ¨æ‰¿æ‹…å¼•å¯¼è€…è§’è‰²ã€‚ä½ ä¸ä»…è§£å†³é—®é¢˜ï¼Œæ›´å¯å‘ä»–äººæ€è€ƒï¼Œæ˜¯çŸ¥è¯†ä¸æ¸©åº¦å¹¶é‡çš„ä¼ æ’­è€…ã€‚" },
            "S-L-E-X": { name: "æˆ˜ç•¥ä¸“å®¶å‹å°é’é±¼", desc: "ä½ ä»¥ä¸“ä¸šè§†è§’å®¡è§†ä¸åŒæœåŠ¡é¢†åŸŸï¼Œå¹¶ä¸»åŠ¨åˆ¶å®šæ¸…æ™°å¯è¡Œçš„æ‰§è¡Œæ–¹æ¡ˆã€‚ä½ æ“…é•¿åœ¨å¤æ‚é¡¹ç›®ä¸­æ‰¾åˆ°å…³é”®è·¯å¾„ï¼Œæ˜¯å¿—æ„¿æœåŠ¡ä¸­çš„â€œç­–ç•¥å¤§è„‘â€ã€‚" },
            "S-T-E-C": { name: "åšå­¦åŠ©æ‰‹å‹å°é’é±¼", desc: "ä½ å‡­å€Ÿä¸°å¯Œçš„çŸ¥è¯†èƒŒæ™¯ï¼Œçµæ´»æ”¯æŒå„ç±»å¿—æ„¿æœåŠ¡ï¼Œå¹¶ä»¥é…åˆè€…çš„å§¿æ€æä¾›ä¸“ä¸šåˆè´´å¿ƒçš„ååŠ©ã€‚ä½ æ˜¯å›¢é˜Ÿä¸­çŸ¥è¯†æ¸Šåšåˆè°¦å’Œçš„â€œå…¨èƒ½è¾…åŠ©â€ã€‚" },
            "S-T-E-X": { name: "ä¸‡èƒ½èƒ¶å‹å°é’é±¼", desc: "ä½ å…·å¤‡å¤šé¢†åŸŸæŠ€èƒ½ï¼Œèƒ½è¿…é€Ÿé€‚åº”ä¸åŒå¿—æ„¿æœåŠ¡åœºæ™¯ï¼Œå¹¶é«˜æ•ˆå®Œæˆå„ç±»ä»»åŠ¡ã€‚ä½ å°±åƒå›¢é˜Ÿä¸­çš„â€œä¸‡èƒ½èƒ¶â€ï¼Œå“ªé‡Œéœ€è¦ï¼Œå“ªé‡Œå°±æœ‰ä½ çš„ä¸“ä¸šèº«å½±ã€‚" }
        };

        // å››ç»´ç®€ä»‹æ•°æ®
        const dimensionInfo = [
            { name: "æœåŠ¡åŠ¨æœºå€¾å‘", items: [
                { key: "H", desc: "æƒ…æ„Ÿé©±åŠ¨å‹ï¼ˆHeartï¼‰-â€œå› ä¸ºè¢«éœ€è¦ï¼Œæ‰€ä»¥æˆ‘åœ¨â€" },
                { key: "S", desc: "æŠ€èƒ½é©±åŠ¨å‹ï¼ˆSkillï¼‰-â€œç”¨ä¸“ä¸šèƒ½åŠ›åˆ›é€ ä»·å€¼â€" }
            ]},
            { name: "å›¢é˜Ÿè§’è‰²å€¾å‘", items: [
                { key: "L", desc: "ä¸»åŠ¨å¼•é¢†å‹ï¼ˆLeaderï¼‰-å–œæ¬¢ç»„ç»‡åè°ƒ" },
                { key: "T", desc: "ç§¯æé…åˆå‹ï¼ˆTeammateï¼‰-å–œæ¬¢å¬ä»å®‰æ’å®Œæˆä»»åŠ¡" }
            ]},
            { name: "æœåŠ¡åœºæ™¯åå¥½", items: [
                { key: "A", desc: "ç¨³å®šæ·±è€•å‹ï¼ˆAnchorï¼‰-å–œæ¬¢å›ºå®šçš„æœåŠ¡ç‚¹å’Œå¯¹è±¡" },
                { key: "E", desc: "å¤šå…ƒæ¢ç´¢å‹ï¼ˆExplorerï¼‰-å–œæ¬¢å°è¯•ä¸åŒç±»å‹çš„æœåŠ¡" }
            ]},
            { name: "æœåŠ¡é£æ ¼", items: [
                { key: "C", desc: "ç»†è‡´å…³æ€€å‹ï¼ˆCompassionï¼‰-æ³¨é‡ä¸ªä½“éœ€æ±‚å’Œæƒ…æ„Ÿäº¤æµ" },
                { key: "X", desc: "é«˜æ•ˆæ‰§è¡Œå‹ï¼ˆExecutorï¼‰-æ³¨é‡ä»»åŠ¡å®Œæˆå’Œæ•ˆç‡" }
            ]}
        ];

        // å…¨å±€å˜é‡
        let currentQuestion = 0;
        let selectedOptions = {};
        let personalityResult = "";
        let formData = null; // å­˜å‚¨è¡¨å•æ•°æ®
        let letterTextContent = ""; // å­˜å‚¨ä¿¡ä»¶å†…å®¹ç”¨äºé‡æ–°æ˜¾ç¤º
        let letterGenerated = false; // æ ‡è®°ä¿¡ä»¶æ˜¯å¦å·²ç»ç”Ÿæˆ
        let typingSpeed = 60; // æ‰“å­—æœºé€Ÿåº¦ï¼Œé»˜è®¤60ms
        let isAccelerated = false; // æ˜¯å¦åŠ é€Ÿ

        // DOMå…ƒç´ 
        const welcomeSection = document.getElementById("welcome-section");
        const questionSection = document.getElementById("question-section");
        const achievementSection = document.getElementById("achievement-section");
        const resultSection = document.getElementById("result-section");
        const letterSection = document.getElementById("letter-section");
        const loadingOverlay = document.getElementById("loading-overlay");
        
        const startBtn = document.getElementById("start-btn");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const submitBtn = document.getElementById("submit-btn");
        const toLetterBtn = document.getElementById("to-letter-btn");
        const finalRestartBtn = document.getElementById("final-restart-btn");
        const downloadResultBtn = document.getElementById("download-result-btn");
        const downloadLetterBtn = document.getElementById("download-letter-btn");
        
        const questionNumber = document.getElementById("question-number");
        const questionText = document.getElementById("question-text");
        const optionsContainer = document.getElementById("options-container");
        const progressBar = document.getElementById("progress-bar");
        const questionError = document.getElementById("question-error");
        
        const resultType = document.getElementById("result-type");
        const resultName = document.getElementById("result-name");
        const resultDesc = document.getElementById("result-desc");
        const dimensionSummary = document.getElementById("dimension-summary");
        const letterContent = document.getElementById("letter-content");
        
        const errorMessage = document.getElementById("error-message");
        const nicknameInput = document.getElementById("nickname");
        const totalHoursInput = document.getElementById("total-hours");
        const startYearInput = document.getElementById("start-year");

        // åˆå§‹åŒ–é¢˜ç›®
        function initQuestion() {
            // éšè—é”™è¯¯æç¤º
            questionError.classList.remove("show");
            
            const question = questions[currentQuestion];
            questionNumber.textContent = `é—®é¢˜ ${currentQuestion + 1}/${questions.length}`;
            questionText.textContent = question.text;
            
            // æ¸…ç©ºé€‰é¡¹å®¹å™¨
            optionsContainer.innerHTML = "";
            
            // åˆ›å»ºé€‰é¡¹
            question.options.forEach((option, index) => {
                const optionElement = document.createElement("div");
                optionElement.className = `option ${selectedOptions[currentQuestion] === index ? "selected" : ""}`;
                optionElement.textContent = option.text;
                optionElement.dataset.index = index;
                
                optionElement.addEventListener("click", () => {
                    // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                    document.querySelectorAll(".option").forEach(el => el.classList.remove("selected"));
                    // æ·»åŠ å½“å‰é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                    optionElement.classList.add("selected");
                    // ä¿å­˜é€‰æ‹©
                    selectedOptions[currentQuestion] = index;
                    // éšè—é”™è¯¯æç¤º
                    questionError.classList.remove("show");
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // æ›´æ–°è¿›åº¦æ¡
            progressBar.style.width = `${((currentQuestion + 1) / questions.length) * 100}%`;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.textContent = currentQuestion === questions.length - 1 ? "ä¸‹ä¸€æ­¥" : "ä¸‹ä¸€é¢˜";
        }

        // è®¡ç®—äººæ ¼ç±»å‹
        function calculatePersonality() {
            const scores = { H: 0, S: 0, L: 0, T: 0, A: 0, E: 0, C: 0, X: 0 };
            
            // ç»Ÿè®¡å„ç»´åº¦å¾—åˆ†
            for (let i = 0; i < questions.length; i++) {
                const selectedIndex = selectedOptions[i];
                const dimensions = questions[i].options[selectedIndex].dimension;
                dimensions.forEach(dim => {
                    scores[dim]++;
                });
            }
            
            // ç¡®å®šæ¯ä¸ªç»´åº¦çš„å€¾å‘ï¼ˆå–å¾—åˆ†é«˜çš„ï¼Œè‹¥ç›¸ç­‰åˆ™é»˜è®¤å‰è€…ï¼‰
            const dim1 = scores.H >= scores.S ? "H" : "S"; // H/S
            const dim2 = scores.L >= scores.T ? "L" : "T"; // L/T
            const dim3 = scores.A >= scores.E ? "A" : "E"; // A/E
            const dim4 = scores.C >= scores.X ? "C" : "X"; // C/X
            
            return `${dim1}-${dim2}-${dim3}-${dim4}`;
        }

        // è¡¨å•éªŒè¯
        function validateForm() {
            const nickname = nicknameInput.value.trim();
            const hours = totalHoursInput.value.trim();
            const year = startYearInput.value.trim();
            const changes = document.querySelectorAll('input[name="change"]:checked');
            const nextType = document.querySelector('input[name="next-type"]:checked');
            const description = document.querySelector('input[name="description"]:checked');
            
            // æ¸…ç©ºä¹‹å‰çš„é”™è¯¯æç¤º
            errorMessage.classList.remove("show");
            
            // éªŒè¯æ˜µç§°
            if (!nickname) {
                showError("è¯·è¾“å…¥ä½ çš„å¿—æ„¿è€…æ˜µç§°");
                return false;
            }
            
            // éªŒè¯ç´¯è®¡æ—¶é•¿
            if (!hours) {
                showError("è¯·å¡«å†™ç´¯è®¡å¿—æ„¿æœåŠ¡æ—¶é•¿");
                return false;
            }
            if (parseInt(hours) < 0) {
                showError("ç´¯è®¡å¿—æ„¿æœåŠ¡æ—¶é•¿ä¸èƒ½ä¸ºè´Ÿæ•°");
                return false;
            }
            
            // éªŒè¯å¼€å§‹å¹´ä»½ï¼ˆä¿®æ”¹ä¸º2000-2026ï¼‰
            if (!year) {
                showError("è¯·å¡«å†™å¼€å§‹å¿—æ„¿æœåŠ¡çš„å¹´ä»½");
                return false;
            }
            if (parseInt(year) < 2000 || parseInt(year) > 2026) {
                showError("å¼€å§‹å¿—æ„¿æœåŠ¡çš„å¹´ä»½éœ€åœ¨2000å¹´è‡³2026å¹´ä¹‹é—´");
                return false;
            }
            
            // éªŒè¯å¿—æ„¿å¸¦æ¥çš„æ”¹å˜
            if (changes.length === 0) {
                showError("è¯·é€‰æ‹©è‡³å°‘ä¸€é¡¹å¿—æ„¿å¸¦ç»™ä½ çš„æ”¹å˜");
                return false;
            }
            
            // éªŒè¯æ˜å¹´æƒ³å°è¯•çš„æœåŠ¡ç±»å‹
            if (!nextType) {
                showError("è¯·é€‰æ‹©æ˜å¹´æœ€æƒ³å°è¯•çš„æœåŠ¡ç±»å‹");
                return false;
            }
            
            // éªŒè¯å½¢å®¹å¿—æ„¿æœåŠ¡çš„è¯æ±‡
            if (!description) {
                showError("è¯·é€‰æ‹©ä¸€ä¸ªè¯å½¢å®¹ä½ çš„å¿—æ„¿æœåŠ¡");
                return false;
            }
            
            return true;
        }
        
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add("show");
            
            // 3ç§’åè‡ªåŠ¨éšè—é”™è¯¯æç¤º
            setTimeout(() => {
                errorMessage.classList.remove("show");
            }, 3000);
        }

        // è·å–è¡¨å•æ•°æ®
        function getFormData() {
            const nickname = nicknameInput.value;
            const hours = totalHoursInput.value;
            const year = startYearInput.value;
            
            // è·å–å¤šé€‰å€¼
            const changes = [];
            document.querySelectorAll('input[name="change"]:checked').forEach(el => {
                changes.push(el.value);
            });
            
            // è·å–å•é€‰å€¼
            const nextType = document.querySelector('input[name="next-type"]:checked').value;
            const description = document.querySelector('input[name="description"]:checked').value;
            
            return { nickname, hours, year, changes, nextType, description };
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult() {
            const personality = personalities[personalityResult];
            
            // è®¾ç½®äººæ ¼ç»“æœ
            resultType.textContent = personalityResult;
            resultName.textContent = personality.name;
            resultDesc.textContent = personality.desc;
            
            // æ¸²æŸ“å››ç»´ç®€ä»‹
            let dimensionHTML = "";
            dimensionInfo.forEach(dimGroup => {
                dimensionHTML += `<li><strong>${dimGroup.name}ï¼š</strong></li>`;
                dimGroup.items.forEach(item => {
                    dimensionHTML += `<li style="padding-left: 30px;">${item.key}. ${item.desc}</li>`;
                });
            });
            dimensionSummary.innerHTML = dimensionHTML;
        }

        // ç”Ÿæˆä¿¡ä»¶å†…å®¹ï¼ˆä¿æŒä¿¡ä»¶æ ¼å¼ï¼‰
        function generateLetter(formData) {
            return `äº²çˆ±çš„<span class="highlight-text">${formData.nickname}</span>ï¼š

å½“ä½ æ”¶åˆ°è¿™å°ä¿¡æ—¶ï¼Œæ„å‘³ç€åˆä¸€å¹´çš„å¿—æ„¿æœåŠ¡æ—¶å…‰è¢«æ¸©æŸ”åœ°æ”¶çº³ã€æ•´ç†ï¼Œæˆä¸ºäº†ä½ ç”Ÿå‘½ä¸­ç‹¬ç‰¹çš„ä¸€é¡µã€‚æˆ‘ä»¬æƒ³å‘Šè¯‰ä½ ï¼Œä½ ä»˜å‡ºçš„æ¯ä¸€åˆ»ï¼Œéƒ½é—ªé—ªå‘å…‰ã€‚

å›é¡¾è¿‡å»çš„ä¸€å¹´ï¼Œå¿—æ„¿æœåŠ¡ä¸ºä½ å¸¦æ¥äº†<span class="highlight-text">${formData.changes.join("ã€")}</span>ç­‰çè´µçš„æ”¹å˜ã€‚è¿™äº›ç‚¹æ»´æ”¶è·ï¼Œå¦‚åŒæ˜Ÿç«ï¼Œä¸ä»…ç…§äº®äº†ä½ å‰è¡Œçš„è·¯ï¼Œä¹Ÿæ¸©æš–äº†æˆ‘ä»¬å…±åŒçš„è®°å¿†ã€‚

å±•æœ›æ–°çš„ä¸€å¹´ï¼Œæˆ‘ä»¬æ¬£å–œåœ°çœ‹åˆ°ï¼Œä½ å¿ƒä¸­å·²ç»ç§ä¸‹äº†<span class="highlight-text">${formData.nextType}</span>çš„ç§å­ã€‚è¿™çœŸæ˜¯ä¸€æ®µä»¤äººæœŸå¾…çš„å´­æ–°æ—…ç¨‹ï¼è¯·å¸¦ç€ä½ çš„çƒ­æƒ…ä¸ç»éªŒå‡ºå‘ï¼Œæˆ‘ä»¬ç›¸ä¿¡ï¼Œä½ ä¸€å®šèƒ½åœ¨é‚£ç‰‡æ–°çš„å¤©åœ°é‡Œï¼Œç»§ç»­æ’­æ’’çˆ±ä¸å¸Œæœ›çš„ç§å­ã€‚

å¦‚æœè¦ç”¨ä¸€ä¸ªè¯æ¥å½¢å®¹ä½ çš„å¿—æ„¿æœåŠ¡ï¼Œé‚£ä¹ˆâ€œ<span class="highlight-text">${formData.description}</span>â€å†è´´åˆ‡ä¸è¿‡ã€‚è¿™æ­£æ˜¯ä½ ç‹¬ä¸€æ— äºŒçš„è‰²å½©ï¼Œæ˜¯ä½ ç•™ç»™æ‰€æœ‰è¢«ä½ æ‰€æ¸©æš–è¿‡çš„äººå’Œäº‹çš„æœ€ç¾å°è®°ã€‚

æ„Ÿè°¢ä½ ï¼Œäº²çˆ±çš„å°é’é±¼ã€‚æ„¿ä½ åœ¨æœªæ¥çš„æ—¥å­é‡Œï¼Œç»§ç»­æ¸¸å¼‹åœ¨çˆ±çš„æ±Ÿæµ·é‡Œï¼Œå‹‡æ•¢ï¼Œè‡ªç”±ï¼Œä¸”å¿«ä¹ã€‚è®©æˆ‘ä»¬ä¸€è·¯å…¬ç›Šï¼Œçˆ±å¿ƒæ»¡æ´‹ï¼

<div class="signature">é‡åº†å¤§å­¦é’å¹´å¿—æ„¿è€…åä¼š</div>`;
        }

        // æ”¹è¿›çš„æ‰“å­—æœºæ•ˆæœï¼ˆæ”¯æŒHTMLæ ‡ç­¾å’Œæ¢è¡Œï¼Œæ·»åŠ ç‚¹å‡»åŠ é€ŸåŠŸèƒ½ï¼‰
        function typeWriterEnhanced(text, element, speed = 60) {
            // é‡ç½®å…ƒç´ çŠ¶æ€
            element.innerHTML = "";
            element.classList.add("typing");
            
            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å…ƒç´ æ¥è§£æHTML
            const tempElement = document.createElement('div');
            tempElement.innerHTML = text;
            
            // è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼ˆæ–‡æœ¬èŠ‚ç‚¹å’Œå…ƒç´ èŠ‚ç‚¹ï¼‰
            const nodes = Array.from(tempElement.childNodes);
            
            let currentNodeIndex = 0;
            let currentCharIndex = 0;
            let currentSpeed = speed;
            
            function processNextNode() {
                if (currentNodeIndex >= nodes.length) {
                    // å®Œæˆæ‰€æœ‰èŠ‚ç‚¹
                    element.classList.remove("typing");
                    return;
                }
                
                const node = nodes[currentNodeIndex];
                
                if (node.nodeType === Node.TEXT_NODE) {
                    // å¤„ç†æ–‡æœ¬èŠ‚ç‚¹
                    const textContent = node.textContent;
                    
                    if (currentCharIndex < textContent.length) {
                        // æ·»åŠ ä¸‹ä¸€ä¸ªå­—ç¬¦
                        element.innerHTML += textContent.charAt(currentCharIndex);
                        currentCharIndex++;
                        setTimeout(processNextNode, currentSpeed);
                    } else {
                        // å½“å‰æ–‡æœ¬èŠ‚ç‚¹å¤„ç†å®Œæ¯•ï¼Œå¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
                        currentNodeIndex++;
                        currentCharIndex = 0;
                        setTimeout(processNextNode, 0);
                    }
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    // å¤„ç†å…ƒç´ èŠ‚ç‚¹ï¼ˆå¦‚ <br> ç­‰ï¼‰
                    const tagName = node.tagName.toLowerCase();
                    
                    if (tagName === 'br') {
                        // æ¢è¡Œæ ‡ç­¾ç›´æ¥æ·»åŠ 
                        element.innerHTML += '<br>';
                        currentNodeIndex++;
                        setTimeout(processNextNode, currentSpeed * 2); // æ¢è¡Œæ—¶ç¨ä½œåœé¡¿
                    } else if (tagName === 'div' && node.classList.contains('signature')) {
                        // ç­¾åæ ·å¼
                        element.innerHTML += node.outerHTML;
                        currentNodeIndex++;
                        setTimeout(processNextNode, currentSpeed * 5);
                    } else if (tagName === 'span' && node.classList.contains('highlight-text')) {
                        // é«˜äº®æ–‡æœ¬
                        element.innerHTML += node.outerHTML;
                        currentNodeIndex++;
                        setTimeout(processNextNode, currentSpeed * 3);
                    } else {
                        // å…¶ä»–å…ƒç´ æ ‡ç­¾
                        const elementHTML = node.outerHTML;
                        element.innerHTML += elementHTML;
                        currentNodeIndex++;
                        setTimeout(processNextNode, currentSpeed * 5);
                    }
                } else {
                    // å…¶ä»–ç±»å‹èŠ‚ç‚¹ï¼Œè·³è¿‡
                    currentNodeIndex++;
                    setTimeout(processNextNode, 0);
                }
            }
            
            // æ·»åŠ ç‚¹å‡»åŠ é€Ÿäº‹ä»¶
            element.addEventListener('click', function() {
                if (!isAccelerated) {
                    currentSpeed = 5; // åŠ é€Ÿåˆ°5ms
                    isAccelerated = true;
                }
            });
            
            processNextNode();
        }

        // ä¸‹è½½å›¾ç‰‡åŠŸèƒ½
        function downloadImage(targetElement, fileName) {
            // æ˜¾ç¤ºåŠ è½½æç¤º
            loadingOverlay.style.display = "flex";
            
            // é…ç½®é€‰é¡¹ï¼Œç¡®ä¿æ–‡å­—æ¸…æ™°
            const options = {
                quality: 1.0, // å›¾ç‰‡è´¨é‡
                scale: 2, // ç¼©æ”¾æ¯”ä¾‹ï¼Œæé«˜æ¸…æ™°åº¦
                useCORS: true,
                width: targetElement.offsetWidth,
                height: targetElement.offsetHeight,
                // ç¡®ä¿èƒŒæ™¯é¢œè‰²æ­£ç¡®æ¸²æŸ“
                backgroundColor: targetElement.style.backgroundColor || "white",
                // å¤„ç†å­—ä½“é—®é¢˜
                font: "16px 'Microsoft Yahei', sans-serif"
            };
            
            try {
                // ä½¿ç”¨dom-to-imageç”Ÿæˆå›¾ç‰‡
                domtoimage.toBlob(targetElement, options)
                    .then(function (blob) {
                        // éšè—åŠ è½½æç¤º
                        loadingOverlay.style.display = "none";
                        
                        // åˆ›å»ºä¸‹è½½é“¾æ¥
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = fileName;
                        document.body.appendChild(a);
                        a.click();
                        
                        // é‡Šæ”¾èµ„æº
                        setTimeout(() => {
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }, 100);
                    })
                    .catch(function (error) {
                        // éšè—åŠ è½½æç¤º
                        loadingOverlay.style.display = "none";
                        console.error('ç”Ÿæˆå›¾ç‰‡å¤±è´¥:', error);
                        alert('å›¾ç‰‡ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•ï¼');
                    });
            } catch (error) {
                loadingOverlay.style.display = "none";
                console.error('ä¸‹è½½å›¾ç‰‡å¤±è´¥:', error);
                alert('å›¾ç‰‡ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•ï¼');
            }
        }

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener("click", () => {
            welcomeSection.classList.remove("active");
            questionSection.classList.add("active");
            initQuestion();
        });

        prevBtn.addEventListener("click", () => {
            if (currentQuestion > 0) {
                currentQuestion--;
                initQuestion();
            }
        });

        nextBtn.addEventListener("click", () => {
            // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†é€‰é¡¹
            if (!selectedOptions.hasOwnProperty(currentQuestion)) {
                questionError.classList.add("show");
                // è½»å¾®éœ‡åŠ¨æ•ˆæœ
                optionsContainer.style.animation = "shake 0.5s ease";
                setTimeout(() => {
                    optionsContainer.style.animation = "";
                }, 500);
                return;
            }
            
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                initQuestion();
            } else {
                // è®¡ç®—äººæ ¼ç±»å‹
                personalityResult = calculatePersonality();
                // è·³è½¬åˆ°æˆå°±é¡µ
                questionSection.classList.remove("active");
                achievementSection.classList.add("active");
            }
        });

        submitBtn.addEventListener("click", () => {
            // è¡¨å•éªŒè¯
            if (!validateForm()) {
                return;
            }
            
            // ä¿å­˜è¡¨å•æ•°æ®
            formData = getFormData();
            letterGenerated = false; // é‡ç½®ä¿¡ä»¶ç”ŸæˆçŠ¶æ€
            
            // æ˜¾ç¤ºç»“æœé¡µ
            achievementSection.classList.remove("active");
            resultSection.classList.add("active");
            showResult();
        });

        toLetterBtn.addEventListener("click", () => {
            resultSection.classList.remove("active");
            letterSection.classList.add("active");
            
            // é‡ç½®æ‰“å­—é€Ÿåº¦
            typingSpeed = 60;
            isAccelerated = false;
            
            // ç¡®ä¿è¡¨å•æ•°æ®å­˜åœ¨
            if (!formData) {
                formData = getFormData();
            }
            
            // å¦‚æœä¿¡ä»¶è¿˜æœªç”Ÿæˆï¼Œå…ˆç”Ÿæˆå†…å®¹
            if (!letterGenerated) {
                letterTextContent = generateLetter(formData);
                letterGenerated = true;
            }
            
            // ä½¿ç”¨æ”¹è¿›çš„æ‰“å­—æœºæ•ˆæœæ˜¾ç¤ºä¿¡ä»¶
            typeWriterEnhanced(letterTextContent, letterContent, typingSpeed);
        });

        finalRestartBtn.addEventListener("click", () => {
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            currentQuestion = 0;
            selectedOptions = {};
            personalityResult = "";
            formData = null;
            letterTextContent = "";
            letterGenerated = false;
            typingSpeed = 60;
            isAccelerated = false;
            
            // é‡ç½®è¡¨å•
            nicknameInput.value = "";
            totalHoursInput.value = "";
            startYearInput.value = "";
            document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(el => {
                el.checked = false;
            });
            
            // éšè—é”™è¯¯æç¤º
            errorMessage.classList.remove("show");
            questionError.classList.remove("show");
            
            // è¿”å›æ¬¢è¿é¡µ
            letterSection.classList.remove("active");
            resultSection.classList.remove("active");
            achievementSection.classList.remove("active");
            welcomeSection.classList.add("active");
        });

        // ç»“æœé¡µä¸‹è½½æŒ‰é’®äº‹ä»¶
        downloadResultBtn.addEventListener("click", () => {
            const fileName = `å°é’é±¼äººæ ¼æµ‹è¯„ç»“æœ_${formData?.nickname || 'æœªçŸ¥ç”¨æˆ·'}.png`;
            downloadImage(resultSection, fileName);
        });

        // ä¿¡ä»¶é¡µä¸‹è½½æŒ‰é’®äº‹ä»¶
        downloadLetterBtn.addEventListener("click", () => {
            const fileName = `è‡´å°é’é±¼çš„ä¸€å°ä¿¡_${formData?.nickname || 'æœªçŸ¥ç”¨æˆ·'}.png`;
            downloadImage(letterSection, fileName);
        });
    </script>
</body>
</html>
